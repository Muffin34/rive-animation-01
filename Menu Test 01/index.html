<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Interactive Menu Test</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      background: #1a1a1a;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    canvas {
      width: 1920px;
      height: 1080px;
      background: #e38a2a; /* match your orange bg or use transparent */
      cursor: pointer;
      display: block;
    }
  </style>
</head>
<body>
  <canvas id="Main"></canvas>
  <script src="https://unpkg.com/@rive-app/canvas@2.30.1/rive.js"></script>
  <script>
    const canvas = document.getElementById('Main');
    const ctx    = canvas.getContext('2d');
    const dpr    = window.devicePixelRatio || 1;

    // Upscale for crisp vectors
    canvas.width  = 1920 * dpr;
    canvas.height = 1080 * dpr;
    canvas.style.width  = '1920px';
    canvas.style.height = '1080px';
    ctx.scale(dpr, dpr);

    // Menu items & state‐machine triggers
    const menuItems = [
      'Continue',
      'Start Game',
      'Load Game',
      'Settings',
      'Exit'
    ];

    let riveInstance, triggersMap;

    new rive.Rive({
      src: encodeURI('menu_test_01.riv'),   // your file
      artboard: 'Main',                     // your artboard name
      canvas,
      autoplay: true,
      antialias: true,
      stateMachines: ['State Machine 1'],   // your SM name
      layout: new rive.Layout({
        fit:       rive.Fit.Contain,
        alignment: rive.Alignment.Center
      }),
      onLoad(inst) {
        riveInstance = inst;
        // Build a map: { "Continue": triggerInput, ... }
        const inputs = riveInstance.stateMachineInputs('State Machine 1');
        triggersMap = {};
        menuItems.forEach(name => {
          const inp = inputs.find(i => i.name === name && i.type === 'trigger');
          if (inp) triggersMap[name] = inp;
        });
      },
      onError(err) {
        console.error('Rive load error:', err);
      }
    });

    // Helper: find which item index (0–4) based on pointer Y
    function hitIndex(clientY) {
      const rect = canvas.getBoundingClientRect();
      const relY = (clientY - rect.top) / rect.height; // 0–1
      let idx = Math.floor(relY * menuItems.length);
      if (idx < 0) idx = 0;
      if (idx >= menuItems.length) idx = menuItems.length - 1;
      return idx;
    }

    // On hover, fire the highlight trigger
    canvas.addEventListener('mousemove', e => {
      if (!triggersMap) return;
      const idx = hitIndex(e.clientY);
      const name = menuItems[idx];
      const trig = triggersMap[name];
      if (trig) trig.fire();
    });

    // On click, fire the same trigger (or you could fire a different one)
    canvas.addEventListener('click', e => {
      if (!triggersMap) return;
      const idx = hitIndex(e.clientY);
      const name = menuItems[idx];
      const trig = triggersMap[name];
      if (trig) trig.fire();
      // TODO: also call your own JS handler, e.g. startGame(), etc.
      console.log('Clicked menu item:', name);
    });
  </script>
</body>
</html>
